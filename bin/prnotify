#!/usr/bin/env sh

if [[ $(hub ci-status) == "no status" ]]; then
    echo "No PR status yet. Waiting ten seconds then trying again."
    sleep 10
fi

if [[ $(hub ci-status) == "pending" ]]; then
    while [[ $(hub ci-status) == "pending" ]]; do sleep 20; done
fi

# notify user
pr_status="$(hub ci-status)"
msg="Github PR status for directory $PWD : $pr_status. PR link copied to clipboard."
echo "$msg"
notify-send "$msg"
# copy PR link to clipboard
hub pr show -c
# copy PR link from clipboard to primary
xclip -selection clipboard -o | xclip -selection primary -i -f
